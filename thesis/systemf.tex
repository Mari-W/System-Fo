\subsection{Specification}
We will first look at System F, our target language of the Dictionary Passing Transform. 
The specification includes Syntax, Typing and Semantic. 

\subsubsection{Sorts}\hfill\\\\
System F only requires two sorts, \Constr{eₛ} for expressions and \Constr{τₛ} for types. 
\FSort
Going forward, we use \Sym{s} as variable name for sorts and \Sym{S} for a list of sorts.

\subsubsection{Syntax}\hfill\\\\
System F's syntax is represented in a single data type \Data{Term} indexed by a list of sorts \Sym{S} and a sort \Sym{s}. 
The length of \Sym{S} represents the amount of bound variables and the elements \Sym{s$_i$} of the list provide the sort of the variable bound at that position. 
The second index \Sym{s} represents the sort of the term itself.
\FTerm
Variables \Constr{`}\ \Sym{x} are represented as references \Sym{s} \Prim{∈} \Sym{S} to an element in \Sym{S}.
Memberships of type \Sym{s} \Prim{∈} \Sym{S} are defined similar to natural numbers and can either be \Constr{here refl} where \Constr{refl} is prove we found our element or \Constr{there} \Sym{x} where \Sym{x} is another membership. 
In consequence we can only reference already bound variables, in a similar fashion to debruijn indices. 
The unit element \Constr{tt} and unit type \Constr{`⊤} represent base types. Lambda abstractions \Constr{λ`x→} \Sym{e'} result in function types \Sym{τ₁} \Constr{⇒} \Sym{τ₂} and type abstractions \Constr{Λ`α→} \Sym{e'} result in forall types \Constr{∀`α} \Sym{τ'}. 
To eliminate abstractions we use application \Sym{e₁} \Constr{·} \Sym{e₂} for lambda abstractions and type application \Sym{e} \Constr{•} \Sym{τ} for type abstractions. 
Let bindings \Constr{let`x=} \Sym{e₂} \Constr{`in} \Sym{e₁} combine abstraction and application. 
We will use shorthands \FVar, \FExpr\ and \FType\ and variable names \Sym{x}, \Sym{e} and \Sym{τ} respectively as well as \Sym{t} for arbitrary \Data{Term} \Sym{S} \Sym{s}.

\subsubsection{Renaming}\hfill\\\\
Renamings \Sym{ρ} of type \Data{Ren} \Sym{S₁} \Sym{S₂} are defined as total functions mapping variables \Data{Var} \Sym{S₁} \Sym{s} to variables \Data{Var} \Sym{S₂} \Sym{s} preserving the sort \Sym{s} of the variable.
\FRen
Applying a renaming \Data{Ren} \Sym{S₁} \Sym{S₂} to a term \Data{Term} \Sym{S₁} \Sym{s} yield a new term \Data{Term} \Sym{S₂} \Sym{s} where variables are represented as references \Sym{s} \Prim{∈} \Sym{S₂} to elements in \Sym{S₂}.
\Fren
When going under a binder, the renaming is extended using \Frenext. 
The weakening of a term can be defined as shifting all variables by one.
\Fwk 
Since variables are represented as references to a list, we shift them by wrapping a given reference in the \Constr{there} constructor.

\subsubsection{Substitution}\hfill\\\\
Substitutions \Sym{σ} of type \Data{Sub} \Sym{S₁} \Sym{S₂} are similar to renamings but rather than mapping variables to variables, substitutions map variables to terms.
\FSub
Applying a substitution to a term \Fsub\ is analogous to the applying a renaming. 
Single substitution is constructed by composing \Fsinglesub\ with identity substitution \Fidsub\ of type \Data{Sub} \Sym{S S}.
\Fsubs

\subsubsection{Context}\hfill\\\\
The typing context \Data{Ctx} \Sym{S} is indexed by sorts \Sym{S} similar to terms. 
\FCtx
A context can either be empty \Constr{∅} or cons \Sym{Γ} \Constr{▶} \Sym{T} where \Sym{T} is of type \Data{Types} \Sym{S} \Sym{s}. 
Type \Data{Types} \Sym{S} \Sym{s} is defined as 
\FTypes
and has two overlapping meanings. 
First, \Data{Types} \Sym{S} \Sym{s} represents the type of what is stored in the context for a variable of sort \Sym{s}. 
For expressions \Sym{e} we expect the context to store the corresponding type \Sym{τ}.
For types \Sym{τ} we store the corresponding kind of unit type \Data{⊤}, since System F only has one kind for types.
Additionally \Data{Types} \Sym{S} \Sym{s} represents the outcome of the typing relation \Sym{Γ} \Data{⊢} \Sym{t} \Data{:} \Sym{T} for terms.

\subsubsection{Typing}\hfill\\\\
The typing relation \Sym{Γ} \Data{⊢} \Sym{t} \Data{:} \Sym{T} relates terms \Sym{t} to their typing of type \Data{Types} \Sym{S} \Sym{s} in context \Sym{Γ}.
\FTyping
Rule \Constr{⊢`x} says that variables \Constr{`} \Sym{x} have type \Sym{τ} if \Sym{x} has type \Sym{τ} in \Sym{Γ}.

\subsubsection{Semantics}

\subsection{Soundness}
\subsubsection{Progress}\hfill\\\\
\subsubsection{Subject Reduction}
